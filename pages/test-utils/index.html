<!doctype html><html lang="en"><head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta property="og:title" content="Tybalt">
        <meta property="og:description" content="A framework for writing web components.">
        <meta property="og:image" content="https://doug-wade.github.io/tybalt/img/favico.png">

        <title>Tybalt test utils</title>
        <link rel="manifest" href="manifest.json">
        <link rel="shortcut icon" type="image/png" href="img/favico.png">
        <link href="/css/base.css" rel="stylesheet">
        <link href="/css/page.css" rel="stylesheet">
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
        <link href="https://fonts.googleapis.com/css2?family=DM+Mono&amp;family=DM+Sans:ital,wght@0,400;0,700;1,400&amp;display=swap" rel="stylesheet">
        <link href="https://unpkg.com/prism-themes@1.9.0/themes/prism-night-owl.css" rel="stylesheet">

        <!-- Sentry tag -->
        <script crossorigin="anonymous" src="https://js.sentry-cdn.com/93129628db91d6ba5031c0453b456533.min.js"></script>
        <script>
            if (window.Sentry) {
                Sentry.init({
                    release: "@tybalt/website@0.1.9+49eff404e49f2894aa7b5983f4af2b1cc4b1bb87",
                    environment: "staging",
                    dsn: "https://93129628db91d6ba5031c0453b456533@o4506661698535424.ingest.sentry.io/4506758769737728",
                    tracesSampleRate: 1.0,
                    tracePropagationTargets: ["localhost", /^https:\/\/tybalt\.org/],
                    replaysSessionSampleRate: 0.1,
                    replaysOnErrorSampleRate: 1.0,
                });
            }
        </script>

        <!-- Service Worker -->
        <script>
            if ("serviceWorker" in navigator) {
              navigator.serviceWorker
                .register("/service-worker.js")
                .then((registration) => {
                  registration.addEventListener("updatefound", () => {
                    const newWorker = registration.installing;
                    newWorker.addEventListener("statechange", () => {
                      if (newWorker.state === "installed") {
                        if (navigator.serviceWorker.controller) {
                          // New service worker installed and registered, we reload the page
                          window.location.reload();
                        }
                      }
                    });
                  });
                })
                .catch((error) => {
                  console.error("Service Worker registration failed:", error);
                });
            }
          </script>
    </head>
    <body>
        <div id="app">
            <tybalt-header></tybalt-header>
            <div id="content">
                <tybalt-sidebar></tybalt-sidebar>
                <div class="tybalt-main"><h1>@tybalt/test-utils</h1>
<p>The test-utils package is for unit testing web components. It's built specifically for Tybalt, but it works for most web component frameworks -- see our Lit example on GitHub.</p>
<p>A simple test might look like</p>
<pre><code class="language-js">it('emits a click event when the button is clicked', async () =&gt; {
    const wrapper = await mountCookieBanner();

    const actual = wrapper.find('button');
    actual.trigger('click');

    expect(wrapper.emitted('click')).toHaveLength(1);
});
</code></pre>
<p>See the API section below for more examples.</p>
<h2>Installation</h2>
<pre><code class="language-shell">npm install --save-dev @tybalt/test-utils
</code></pre>
<h2>Setup</h2>
<p>You'll need to add the setup script to your <code>jest.config.js</code>.</p>
<p>In commonjs</p>
<pre><code class="language-javascript">module.exports = {
    setupFilesAfterEnv: ['./node_modules/@tybalt/test-utils/dist/cjs/setup.js'],
};
</code></pre>
<p>In esm</p>
<pre><code class="language-javascript">export default {
    setupFilesAfterEnv: ['./node_modules/@tybalt/test-utils/dist/mjs/setup.js'],
};
</code></pre>
<h2>Usage</h2>
<pre><code class="language-javascript">import { mount } from '@tybalt/test-utils';
import MyComponent from './my-component';

describe('component', () =&gt; {
    it('renders', async () =&gt; {
        const wrapper = await mount(MyComponent);

        expect(wrapper.html()).toBe(`&lt;my-component&gt;&lt;/my-component&gt;`);
    });
});
</code></pre>
<h2>Api</h2>
<h3>flushPromises</h3>
<pre><code class="language-javascript">await flushPromises();
</code></pre>
<pre><code class="language-javascript">import { flushPromises, mount } from '@tybalt/test-utils';
import MyComponent from './my-component';

describe('component', () =&gt; {
    it('renders', async () =&gt; {
        const wrapper = await mount(MyComponent);

        // wait for asynchronous action, like a fetch request, that is performed when mounting to be completed
        await flushPromises();

        expect(wrapper.text()).toBe(`&lt;expected content&gt;`);
    });
});
</code></pre>
<h3>mount</h3>
<p>Use <code>mount</code> to create an instance of a web component.</p>
<p><code>mount</code> takes two arguments, the component definition, and an optional <code>options</code> object that can have
an attributes and slot key on it. The attributes argument is an object in the shape
<code>{ attributeKey: "attributeValue" }</code>, and the slot is a string of html that should be place inside the
web component.</p>
<pre><code class="language-javascript">import { mount } from '@tybalt/test-utils';
import MyComponent from './my-component';

describe('component', () =&gt; {
    it('renders', async () =&gt; {
        const attributes = {};
        const slot = 'this is slot content';
        const wrapper = await mount(MyComponent, { attributes, slot });

        expect(wrapper.html()).toBe(`&lt;my-component&gt;&lt;/my-component&gt;`);
    });
});
</code></pre>
<h3>wrapper</h3>
<p>The wrapper is a convenience class for testing DOM elements. Wrapper is an interface that has multiple implemenetations,
and is returned from methods like <code>find</code>, <code>mount</code> and <code>findComponentAll</code>.</p>
<h4>attributes</h4>
<p>The attributes method is used to get the value of attributes that are passed to an element. It takes a single, optional
parameter, <code>attributeName</code>, the name of the attribute to get the value for.</p>
<pre><code class="language-javascript">const attributeName = 'name';
const attributeValue = 'value';

const wrapper = mount(MyComponent, { [attributeName]: attributeValue });

expect(wrapper.attributes(attributeName)).toBe(attributeValue);
</code></pre>
<p>If the optional parameter is not provided, instead an object is returned where the keys are all of the attributes, and
their corresponding values are the attribute values.</p>
<pre><code class="language-javascript">const attributeName = 'name';
const attributeValue = 'value';

const wrapper = mount(MyComponent, { [attributeName]: attributeValue });

expect(wrapper.attributes()).toBe({ [attributeName]: attributeValue });
</code></pre>
<h4>classes</h4>
<p>The classes method is used to indicate the presence of classes that are present on an element. It takes a single,
optional parameter, <code>className</code>, the name of the attribute to check for the presence of.</p>
<pre><code class="language-javascript">const className = 'my-class';
const MyComponent = defineComponent({
    render() {
        return html`&lt;div class="${className}"&gt;&lt;/div&gt;`;
    },
});

const wrapper = mount(MyComponent);

expect(wrapper.classes(className)).toBeTruthy();
</code></pre>
<p>If the optional parameter is not provided, instead an object is returned where the keys are all of the attributes, and
their corresponding values are the attribute values.</p>
<pre><code class="language-javascript">const className = 'my-class';
const MyComponent = defineComponent({
    render() {
        return html`&lt;div class="${className}"&gt;&lt;/div&gt;`;
    },
});

const wrapper = mount(MyComponent);

expect(wrapper.classes()).toBe({ [className]: true });
</code></pre>
<h4>exists</h4>
<p>Indicates whether an element exists or not.</p>
<p>For example, if you call this method on the result of a <code>mount</code> call, it will return <code>true</code> because <code>mount</code> returns
an element.</p>
<pre><code class="language-javascript">const wrapper = mount(MyComponent);

expect(wrapper.exists()).toBeTruthy();
</code></pre>
<p>If, instead, you query the result for a element that is not present, it will return <code>false</code>.</p>
<pre><code class="language-javascript">const MyComponent = defineComponent({
    render() {
        return html`&lt;div&gt;Hello World&lt;/div&gt;`;
    },
});

const wrapper = mount(MyComponent);
const element = wrapper.find('button');

expect(element.exists()).not.toBeTruthy();
</code></pre>
<h4>find</h4>
<p>Finds an element that is a descendant of this wrapper that matches a
<a href="https://developer.mozilla.org/en-US/docs/Web/API/Document_object_model/Locating_DOM_elements_using_selectors">CSS selector string</a>.
Only returns the first element matching the selector.</p>
<pre><code class="language-javascript">const MyComponent = defineComponent({
    render() {
        return html`&lt;div&gt;Hello World&lt;/div&gt;`;
    },
});
const wrapper = mount(MyComponent);
const element = wrapper.find('div[data-jest="my-selector"]');

expect(element.exists()).toBeTruthy();
</code></pre>
<h4>findAll</h4>
<p>Finds all elements that are descendants of this wrapper that match a
<a href="https://developer.mozilla.org/en-US/docs/Web/API/Document_object_model/Locating_DOM_elements_using_selectors">CSS selector string</a>.
Returns all elements matching the selector.</p>
<pre><code class="language-javascript">const MyComponent = defineComponent({
    render() {
        return html`&lt;ul&gt;
            &lt;li&gt;one&lt;/li&gt;
            &lt;li&gt;two&lt;/li&gt;
            &lt;li&gt;three&lt;/li&gt;
        &lt;/ul&gt;`;
    },
});
const wrapper = mount(MyComponent);
const elements = wrapper.findAll('li');

expect(elements.length).toBe(3);
</code></pre>
<h4>findComponent</h4>
<p>Finds an element that is a descendant of this wrapper that is an instance of the constructor provided as the first
argument. Only returns the first element that is an instance of the constructor.</p>
<pre><code class="language-javascript">const MyComponent = defineComponent({
    render() {
        return html`&lt;div&gt;&lt;my-other-component&gt;&lt;/my-other-component&gt;&lt;/div&gt;`;
    },
});
const wrapper = mount(MyComponent);
const element = wrapper.findComponent(MyOtherComponent);

expect(element.exists()).toBeTruthy();
</code></pre>
<h4>findComponentAll</h4>
<p>Finds all elements that are descendants of this wrapper that are an instance of the constructor provided as the first
argument. Returns all elements that is an instance of the constructor.</p>
<pre><code class="language-javascript">const MyComponent = defineComponent({
    render() {
        return html` &lt;ul&gt;
            &lt;li&gt;&lt;my-other-component&gt;&lt;/my-other-component&gt;&lt;/li&gt;
            &lt;li&gt;&lt;my-other-component&gt;&lt;/my-other-component&gt;&lt;/li&gt;
            &lt;li&gt;&lt;my-other-component&gt;&lt;/my-other-component&gt;&lt;/li&gt;
        &lt;/ul&gt;`;
    },
});
const wrapper = mount(MyComponent);
const elements = wrapper.findComponentAll(MyOtherComponent);

expect(elements.length).toBe(3);
</code></pre>
<h4>html</h4>
<p>Returns a string of the html of a wrapper.</p>
<pre><code class="language-javascript">const template = `&lt;div&gt;&lt;span&gt;foo&lt;/span&gt;&lt;span&gt;bar&lt;/span&gt;&lt;span&gt;baz&lt;/span&gt;&lt;/div&gt;`;
const MyComponent = defineComponent({ template });

const wrapper = mount(MyComponent);

expect(wrapper.html()).toBe(template);
</code></pre>
<p><code>html</code> returns the html <em>as it would be seen by a third-party script</em>. For instance, if you use the shadow DOM and you
close it, the shadow DOM will not be returned from <code>html</code>.</p>
<pre><code class="language-javascript">const template = `&lt;div&gt;my secret DOM&lt;/div&gt;`;
const MyComponent = defineComponent({ template, shadowMode: 'closed' });

const wrapper = mount(MyComponent);

expect(wrapper.html()).toBe(`&lt;my-component&gt;&lt;/my-component&gt;`);
</code></pre>
<p>If, instead, you have an open shadow DOM, it will be included in the returned <code>html</code>.</p>
<pre><code class="language-javascript">const template = `&lt;div&gt;my open DOM&lt;/div&gt;`;
const MyComponent = defineComponent({ template, shadowMode: 'open' });

const wrapper = mount(MyComponent);

expect(wrapper.html()).toBe(`&lt;my-component&gt;${template}&lt;/my-component&gt;`);
</code></pre>
<h4>length</h4>
<p>Returns the number of DOM elements that are wrapped by this wrapper.</p>
<pre><code class="language-javascript">const wrapper = mount(MyComponent);

expect(wrapper.length).toBe(1);
</code></pre>
<h4>text</h4>
<p>Returns the innerText of an html element.</p>
<pre><code class="language-javascript">const template = `&lt;div&gt;&lt;span&gt;foo&lt;/span&gt;&lt;span&gt;bar&lt;/span&gt;&lt;span&gt;baz&lt;/span&gt;&lt;/div&gt;`;
const MyComponent = defineComponent({ template });

const wrapper = mount(MyComponent);

expect(wrapper.text()).toBe(`foo bar baz`);
</code></pre>
<h4>trigger</h4>
<p>Fires a custom event from the wrapped element.</p>
<pre><code class="language-javascript">const eventName = 'click';
const payload = { foo: 'bar' };

const wrapper = mount(MyComponent);
wrapper.trigger(eventName, payload);
</code></pre>
</div>
            </div>
            <tybalt-footer></tybalt-footer>
        </div>
        <script src="https://unpkg.com/prismjs@v1.x/components/prism-core.min.js"></script>
        <script src="https://unpkg.com/prismjs@v1.x/plugins/autoloader/prism-autoloader.min.js"></script>
        <!-- Google tag (gtag.js) -->
        <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-90R0R9Y7VG"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag() {
                dataLayer.push(arguments);
            }
            gtag('js', new Date());

            gtag('config', 'G-90R0R9Y7VG');
        </script>
    

<script src="/tybalt-out.js"></script></body></html>